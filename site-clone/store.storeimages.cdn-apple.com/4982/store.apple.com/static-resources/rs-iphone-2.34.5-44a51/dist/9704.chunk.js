/*! 2.34.5 | BH: 0aabfe2ef5c1758a5124 | CH: 7f9f8f2fc8 */
/*! License information is available at licenses.txt */"use strict";(globalThis.webpackChunkrs_iphone=globalThis.webpackChunkrs_iphone||[]).push([[9704],{9704:(e,t,o)=>{o.d(t,{A:()=>D,P:()=>O});var a=o(1594),n=o.n(a),l=o(6942),r=o.n(l),i=o(2224),c=o.n(i),s=o(5911),d=o(7427),u=o(4768),h=o(6766),g=o(4067),m=o(8168),p=o(2662),y=o(8595);const L=n().forwardRef((e,t)=>{let{form:o,field:a,geoLocationField:l,geoLocationLabel:r,clearGeoLookupError:i,handleInputChange:c,handleGeoLocationClear:s,handleGeoLocationKeyDown:d,...u}=e;return n().createElement(y.A,(0,m.A)({ref:t,key:a.name,name:a.name,label:a.label,classes:{root:l&&"rc-location-geolocated-text",input:"rc-location-form-text",error:"rc-location-form-errormsg"},value:l?r:o.values[a.name]||"","data-autom":"pinCode",autoComplete:"postalCode"===a.name?"postal-code":void 0,maxLength:a.maxSize,required:a.required,error:l?void 0:o.touched[a.name]&&o.errors[a.name],onBlur:o.handleBlur,onFocus:i,onChange:e=>c(a.name,e.target.value),onClick:l?s:void 0,onKeyDown:l?d:void 0},u))});L.displayName="BaseTextfieldInput";const f=n().forwardRef((e,t)=>{let{form:o,field:a,handleInputChange:l,...r}=e;const i=(0,p.Ay)({value:o.values[a.name]||"",format:a.format}),c={ref:(0,s.E2)(t,i.ref),form:o,field:a,handleInputChange:l,...r,onChange:e=>{const{value:t}=i.onChange(e);l(a.name,t)},onPaste:i.handlePaste};return n().createElement(L,c)});f.displayName="TextFieldInputWithFormatting";const b=e=>{let{field:t,form:o,...a}=e;const l={ref:o.registerFieldRef,field:t,form:o,...a};return t.format?n().createElement(f,l):n().createElement(L,l)};var v=o(5206),E=o(2110),k=o(5646),C=o(2684);const G=e=>e?{width:e.width,left:0}:{},A=e=>{let{typeAheadMinChars:t=1,typeAheadUrl:o,form:a,clearGeoLookupError:l,handleInputChange:r,handleGeoLocationClear:i,handleGeoLocationKeyDown:s,onSubmit:u,geoLocationField:h,geoLocationLabel:g,field:p}=e;const y="searchString",[L,f]=(0,d.oM)({resetDelay:4e3}),[A,F]=n().useState([]),[x,w]=n().useState([]),[D,S]=n().useState(null),M=e=>{const n=e.target.value;D&&n?.length<t&&F([]),S(n),a.setFieldValue(y,n);const l=(0,k.tG)("location-input/location-inline-editor"),r=C.k0(o,{value:n});n?.length>=t&&(0,k.hI)(r).then(e=>{const t=[],o=c().get(e,"body.suggestions",[]);w(o),o.forEach(e=>{t.push(e.displayValue)});const a=c().get(e,"body.suggestionsVOText","");F(t),f(a)}).catch(e=>l.error(e))};return n().createElement(n().Fragment,null,n().createElement(E.A,{value:a.values[p.name],onChange:M,onSelection:e=>{(0,v.flushSync)(()=>{a.setFieldValue(p.name,e)}),(e=>{window?.asMetrics?.autocomplete&&window.asMetrics.autocomplete.onItemSelected("ShippingAddress",A.indexOf(e)+1,A.length)})(e),u(null,(e=>{const t=x.find(t=>t.displayValue===e).fields.reduce((t,o)=>(t[o.name]=o.value,t[y]=e,t),{});return a.setValues(t),t})(e))},options:A,getPosition:G,renderInput:e=>n().createElement(b,(0,m.A)({form:a,field:p,handleInputChange:(e,t)=>{r(e,t),M({target:{value:t}})},geoLocationField:h,geoLocationLabel:g,clearGeoLookupError:l,handleGeoLocationClear:i,handleGeoLocationKeyDown:s},e)),classes:{root:"rf-location-autocomplete"}}),n().createElement(d.Ay,{message:L}))},F=e=>{let{typeAheadUrl:t,isTypeAheadEnabled:o,typeAheadMinChars:a,formFields:l,form:r,geoLocatedAttr:i={},showButton:c,clearGeoLookupError:s,handleInputChange:d,handleSelectChange:u,handleGeoLocationClear:h,handleGeoLocationKeyDown:m,ariaDescribedBy:p,onSubmit:y}=e;const{numFields:L,geoLookup:f,geoLabel:v}=i;return n().createElement("div",{className:"rc-location-field-wrapper"},l.map((e,i)=>{if(!e)return null;const E=1===L&&0===i&&f.isLocated,k=c&&`${v}${r.values[e.name]}`||"";if("text"===e.type)return o?n().createElement(A,{form:r,field:e,onSubmit:y,handleInputChange:d,geoLocationField:E,geoLocationLabel:k,clearGeoLookupError:s,handleGeoLocationClear:h,handleGeoLocationKeyDown:m,typeAheadMinChars:a,typeAheadUrl:t}):n().createElement(b,{form:r,field:e,handleInputChange:d,geoLocationField:E,geoLocationLabel:k,clearGeoLookupError:s,handleGeoLocationClear:h,handleGeoLocationKeyDown:m});if("select"===e.type){const t=l.slice(i+1).filter(e=>"select"===e.type).length;return n().createElement(g.A,{key:e.name,name:e.name,value:r.values[e.name],classes:{root:E&&"rc-location-geolocated-text",error:"rc-location-form-errormsg"},onBlur:r.handleBlur,onChange:u(t),label:e.data[0].text,disabled:e.data.length<=1,required:e.required,error:e.data.length>1&&r.touched[e.name]&&r.errors[e.name],"aria-describedby":0===t?p:""},e.data.map(e=>n().createElement(g.n,{value:e.value,key:e.value,disabled:e.isDisabled},e.text)))}return null}))},x='<svg viewBox="0 0 25 25" class="as-svgicon as-svgicon-location as-svgicon-reduced as-svgicon-locationreduced" role="img" aria-hidden="true" width="25px" height="25px"><path fill="none" d="M0 0h25v25H0z"/><path d="m19.946 5.057-.027.066-6.684 14.388c-.034.073-.075.163-.116.246l-.034-6.57a1.25 1.25 0 0 0-.353-.923 1.24 1.24 0 0 0-.908-.345l-6.565-.043c.078-.037.161-.074.236-.108l14.384-6.682zM20.149 4a1.7 1.7 0 0 0-.69.178L5.073 10.861a2.5 2.5 0 0 0-.8.467.86.86 0 0 0-.052 1.21 1.33 1.33 0 0 0 .942.337l6.649.043a.3.3 0 0 1 .207.052.28.28 0 0 1 .06.216l.035 6.649a1.33 1.33 0 0 0 .337.942.8.8 0 0 0 .561.222.94.94 0 0 0 .658-.274 2.8 2.8 0 0 0 .467-.8l6.688-14.381c.259-.588.225-1-.069-1.3A.83.83 0 0 0 20.149 4"/></svg>',w=e=>{let{numFields:t,geoLookup:o={}}=e;const{isLocated:a,errorMsg:l}=o,i=1===t;return l?n().createElement("span",(0,m.A)({className:"rc-location-geo-svgicon rc-location-geo-error"},(0,s.OH)(x))):i&&a?n().createElement("span",{className:r()("icon","icon-resetsolid","rc-location-clear-geo")}):n().createElement("span",(0,m.A)({className:"rc-location-geo-svgicon rc-location-geo-locate"},(0,s.OH)(x)))},D=e=>{let{typeAheadUrl:t,isTypeAheadEnabled:o,typeAheadMinChars:a,a11yAssets:l={},buttonTextAttr:i={},geoLocatedAttr:g={},showButton:m=!1,showButtonLink:p=!1,consent:y={},form:L,formFields:f,isFetched:b,ariaDescribedBy:v,clearGeoLookupError:E,handleInputChange:k,handleSelectChange:C,handleGeoLocationClick:G,handleGeoLocationClear:A,handleGeoLocationKeyDown:x,fireIconMicroEvent:D=e=>e,handleDudeFormSubmit:S=e=>e,handleApply:M=e=>e,handleReset:I=e=>e}=e;const{geoLookup:T,numFields:N,a11yGeoOffText:O,a11yGeoOnText:V,geoEnabled:B}=g,K=c().get(l,"a11ytext",""),{consent:U,handleChange:$,showConsent:q}=c().get(y,"cookieCompliance",{}),{apply:R,cancel:j,buttonText:H}=i,P=c().get(T,"errorMsg",""),z=c().get(T,"isLocated",!1)&&1===N,[_,W]=(0,d.oM)({resetDelay:4e3});n().useEffect(()=>{W(K)},[K]);return b?n().createElement("div",{className:r()("rc-location-input",{"rc-location-singleinput":1===N,"rc-location-multiple-geoinput":N>1})},n().createElement("div",{className:"rc-location-inline-editor"},n().createElement(F,{typeAheadUrl:t,isTypeAheadEnabled:o,typeAheadMinChars:a,formFields:f,form:L,geoLocatedAttr:g,showButton:m,clearGeoLookupError:E,handleInputChange:k,handleSelectChange:C,handleGeoLocationClick:G,handleGeoLocationClear:A,handleGeoLocationKeyDown:x,ariaDescribedBy:v,onSubmit:S})),m&&n().createElement("div",{className:"rc-location-geo-span"},B&&n().createElement("button",{type:"button",onClick:e=>(e=>{z?(A(e),D("reset Geolocation")):(G(e,o),D("Geolocation"))})(e),className:r()("rc-location-geo-icon",{"rc-location-typeahead":o})},n().createElement("span",{className:"visuallyhidden"},z?O:V),n().createElement(w,{numFields:N,geoLookup:T})),!o&&n().createElement("button",{type:"submit",className:r()("button","button-super","button-block","rc-location-button"),"data-autom":"viewOptions",onClick:e=>S(e)},H),_&&n().createElement(d.Ay,{message:_})),p&&n().createElement("div",{className:"rc-location-inline-buttons"},n().createElement("button",{type:"submit",className:"as-buttonlink rc-location-inline-apply-button",onClick:e=>M(e)},n().createElement("span",(0,s.OH)(R)),n().createElement("span",{className:"visuallyhidden"},l.a11yText)),n().createElement("button",{type:"button",className:"as-buttonlink rc-location-inline-reset-button",onClick:e=>I(e)},n().createElement("span",(0,s.OH)(j)),n().createElement("span",{className:"visuallyhidden"},l.a11yText))),m&&n().createElement("div",{className:r()("rc-location-geo-errormessage",u.A.CAPTION)},P),q&&n().createElement("div",null,n().createElement(h.A,{consent:U,handleChange:$,label:y.label}))):""};var S=o(2787),M=o(9832);const I=e=>Object.keys(e).filter(t=>void 0!==e[t]&&null!==e[t]&&""!==e[t]).reduce((t,o)=>{return"parts"===o&&Array.isArray(e[o])?{...t,...(a=e[o],a.reduce((e,t,o)=>t&&"object"==typeof t?(t.part&&(e[`parts.${o}`]=t.part),t.option&&(e[`option.${o}`]=t.option.join(",")),t.cppart&&(e.cppart=t.cppart),e):(e[`parts.${o}`]=t,e),{}))}:Array.isArray(e[o])?(e[o].forEach((e,a)=>{t[`${o}.${a}`]=e}),t):(t[o]=e[o],t);var a},{}),T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=(0,k.tG)("location-input/utils/getLocalityLookup"),a=I(t),n=C.k0(e,a);return(0,k.hI)(n,{method:"GET",cache:"no-cache",timeout:2e4}).then(e=>c().get(e,"body",{})).catch(e=>o.error(e))},N=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=(0,k.tG)("location-input/utils/getLocationUpdate"),a=I(t),n=C.k0(e,a);return(0,k.hI)(n).then(e=>c().get(e,"body.content",{})).catch(e=>o.error(e))},O=function(e){let{bootstrap:t}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c().noop;const n=c().get(t,"localityLookupData.a11yGeoOffText",""),l=c().get(t,"localityLookupData.a11yGeoOnText",""),r=c().get(t,"consent",{}),i=c().get(t,"geoLookupUrl",""),s=c().get(t,"localityLookupData.geoLabel",""),d=c().get(t,"localityLookupUrl",""),u=c().get(t,"locationUrl",""),h=(0,M.A)(r),g=c().get(h,"getConsentCookie"),[m,p]=(0,a.useState)(!1),[y,L]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),[v,E]=(0,a.useState)({}),[C,G]=(0,a.useState)({isLocated:m&&y,errorMsg:void 0}),{initialValues:A,validationSchema:F}=(0,a.useMemo)(()=>(e=>{const t={},o={},a=c().get(e,"localityLookupData",{}),n=c().get(a,"localityLookupFields",[]);return e&&e.localityLookupData&&n.forEach(e=>{const n=a[e];"text"===n.type&&(t[e]=n.value||"",n.fieldValues&&(t.fieldValues=n.fieldValues)),"select"===n.type&&(t[e]=n.data.reduce((e,t)=>"true"===t.selected?t.value:e,"")),o[e]=[],n.required&&o[e].push({type:"required",message:n.requiredErrorMsg}),n.validRegexes&&o[e].push({type:"regex",regEx:n.validRegexes,message:n.invalidErrorMsg})}),{initialValues:t,validationSchema:o}})(v),[v]),x=(0,S.A)({initialValues:A,validationSchema:F}),w=()=>G(e=>({...e,errorMsg:void 0}));(0,a.useEffect)(()=>{x.resetForm(),x.setValues(A)},[A]),(0,a.useEffect)(()=>{r.showConsent&&g()},[]);const D=()=>{N(u).then(e=>(e=>{const o=c().get(e,"address",{}),a=c().get(e,"geoLocated"),n=c().get(e,"geoEnabled");p(n),L(a),G(e=>({...e,isLocated:a&&n})),c().isEmpty(o)?(E({...t}),b(!0)):T(d,{geoLocated:a,...o}).then(e=>{E({localityLookupData:{...e}}),b(!0)})})(e))};(0,a.useEffect)(()=>{D()},[]);const I=(e,t)=>{x.resetForm(),x.setValues(e),t&&B(null,e,t)},O=()=>{G(e=>({...e,isLocated:!1}))},V=(e,t)=>{T(d,{geoLocated:t,...e}).then(e=>{E({localityLookupData:{...e}})})},B=(e,t,a)=>{if(e&&(e.preventDefault(),x.submitForm(e)),x.validateForm(),x.isValid||a&&x.isDirty){const e=t||x.values.fieldValues||x.values;N(u,{geoLocated:C.isLocated,...e}),o({...e},C.isLocated),C.errorMsg&&w()}},K=()=>{O(),I((e=>Object.keys(e).reduce((e,t)=>(e[t]="",e),{}))(A))},U=c().get(v,"localityLookupData.localityLookupFields",[]).map(e=>({name:e,...v.localityLookupData[e]})),$=c().isEmpty(v)?"":c().get(v,"localityLookupData.localityLookupFields.length",""),q={label:r.label,cookieCompliance:h};return{form:x,formFields:U,isFetched:f,geoLocatedAttr:{a11yGeoOnText:l,a11yGeoOffText:n,geoLookup:C,geoEnabled:m,geoLabel:s,numFields:$},consent:q,getConsentCookie:g,clearGeoLookupError:w,handleInputChange:(e,t)=>{x.setFieldValue(e,t),C.isLocated&&O()},handleSelectChange:e=>t=>{if(x.handleChange(t),e){const e={...x.values,[t.target.name]:t.target.value};V(e,C.isLocated)}C.isLocated&&O()},handleFormSubmit:B,handleReset:I,handleGeoLocationClick:(e,t)=>{(e=>{const t=(0,k.tG)("location-input/utils/getGeoLookup");return(0,k.hI)(e,{method:"GET",timeout:2e4}).then(e=>c().get(e,"body",{})).catch(e=>t.error(e))})(i).then(e=>{if(G(t=>({...t,isLocated:e.geoLocated,errorMsg:e.errorMsg||""})),e.address){e.reloadFields&&V(e.address,!0);const o=Object.keys(e.address).reduce((t,o)=>{const a=c().get(e,`address[${o}]`,"");return t[o]=null===a?"":a,t},{});I(o,t)}})},handleGeoLocationClear:K,handleGeoLocationKeyDown:e=>{13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),K())},locationUpdate:D}}}}]);